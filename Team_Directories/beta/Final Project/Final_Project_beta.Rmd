---
title: "Final Project: Willow"
subtitle: "Merrimack College DSE6630: Healthcare & Life Sciences Analytics"
author: "Adeline Casali, Samantha Harper, Scott Eugley"
date: "30 June 2024"
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
    fig_crop: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      cache = FALSE,    ### Turned off so students don't have issues with GitHub
                      cache.comments = TRUE,
                      size = 13)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
# Turn off scientific notation
options(scipen=999)

# Set seed; add CMRG for parallelization
set.seed(50009, "L'Ecuyer-CMRG")

# Clean, set up, and load
pacman::p_unload(pacman::p_loaded(), character.only = TRUE)
rm(list = ls(all = TRUE))

pacman::p_load(tidyverse, 
               ggplot2, 
               kableExtra,
               DESeq2,
               RColorBrewer,
               gridExtra,
               miniml, 
               ggrepel,
               e1071,
               Biobase, 
               caret,
               GEOquery, 
               ROCR, 
               pROC, 
               randomForest,
               ranger,
               multtest,
               nestedcv,
               Rfast, 
               pdp, 
               vip, 
               kernlab, 
               BiocManager
)
```


# Introduction

# Data Processing

```{r}
#Load Raw Counts
#Note: I renamed the file for ease and because I think the extra '.' was messing with the read function
willow <- read_tsv("./Data/GeneCounts.tsv")

#Make GeneID the row names and remove column
rownames(willow) <- willow$GeneID
willow <- willow[ ,-1]

#Load Gene Annotation Data
#This shows info for each gene

GeneAnnotation <- read_tsv("./Data/Human.GRCh38.p13.annot.tsv")

#Load MetaData
metadata <- read_tsv("./Data/GSE260487_gene.fpkm.txt",
                     show_col_types = FALSE) %>% 
            as.data.frame() %>% 
            mutate_if(is.character, as.factor)
```
```{r}
# Data Processing using Soft file
gse <- getGEO("GSE218490", GSEMatrix = TRUE)

# Access the first ExpressionSet object
eset <- gse[[1]]

# Extract expression data
exprs_data <- exprs(eset)
head(exprs_data)

# Extract phenotype data (sample metadata)
pheno_data <- pData(eset)
head(pheno_data)

# Extract feature data (gene/probe metadata)
feature_data <- fData(eset)
head(feature_data)

# Inspect phenotype data
colnames(pheno_data)
head(pheno_data)

# Inspect feature data
colnames(feature_data)
head(feature_data)

# Inspect the assay data
assay_data <- exprs(gse[[1]])
head(assay_data)

# Inspect the phenotype data
pheno_data <- pData(phenoData(gse[[1]]))
head(pheno_data)
```

```{r}
# Create DESeqDataSet object
dds <- DESeqDataSetFromMatrix(
  countData = willow,
  colData = pheno_data,
  design = ~ characteristics_ch1.1
)
```


# Random Forest

# Results and Discussion

# Conclusion